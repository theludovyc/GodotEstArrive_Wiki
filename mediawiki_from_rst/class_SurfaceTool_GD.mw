__NOTOC__'''Inherits:''' [[Reference GD|Reference]] '''<''' [[Object GD|Object]]Helper tool to create geometry.== Description ==The {{Span|SurfaceTool}} is used to construct a [[Mesh GD|Mesh]] by specifying vertex attributes individually. It can be used to construct a [[Mesh GD|Mesh]] from a script. All properties except indices need to be added before calling [[#add_vertex|add_vertex]]. For example, to add vertex colors and UVs:::    var st = SurfaceTool.new()    st.begin(Mesh.PRIMITIVE_TRIANGLES)    st.add_color(Color(1, 0, 0))    st.add_uv(Vector2(0, 0))    st.add_vertex(Vector3(0, 0, 0))The above {{Span|SurfaceTool}} now contains one vertex of a triangle which has a UV coordinate and a specified [[Color GD|Color]]. If another vertex were added without calling [[#add_uv|add_uv]] or [[#add_color|add_color]], then the last values would be used.Vertex attributes must be passed '''before''' calling [[#add_vertex|add_vertex]]. Failure to do so will result in an error when committing the vertex information to a mesh.Additionally, the attributes used before the first vertex is added determine the format of the mesh. For example, if you only add UVs to the first vertex, you cannot add color to any of the subsequent vertices.== Methods =={| class="wikitable | void|| [[#add_bones|add_bones]] '''(''' [[PackedInt32Array GD|PackedInt32Array]] bones ''')'''                                                                                                                                                                                                                                                                                                                                                                                                 |-| void|| [[#add_color|add_color]] '''(''' [[Color GD|Color]] color ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                       |-| void|| [[#add_index|add_index]] '''(''' int index ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                           |-| void|| [[#add_normal|add_normal]] '''(''' [[Vector3 GD|Vector3]] normal ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                |-| void|| [[#add_smooth_group|add_smooth_group]] '''(''' bool smooth ''')'''                                                                                                                                                                                                                                                                                                                                                                                                          |-| void|| [[#add_tangent|add_tangent]] '''(''' [[Plane GD|Plane]] tangent ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                 |-| void|| [[#add_triangle_fan|add_triangle_fan]] '''(''' [[PackedVector3Array GD|PackedVector3Array]] vertices, [[PackedVector2Array GD|PackedVector2Array]] uvs=PackedVector2Array(  ), [[PackedColorArray GD|PackedColorArray]] colors=PackedColorArray(  ), [[PackedVector2Array GD|PackedVector2Array]] uv2s=PackedVector2Array(  ), [[PackedVector3Array GD|PackedVector3Array]] normals=PackedVector3Array(  ), [[Array GD|Array]] tangents=[  ] ''')''' |-| void|| [[#add_uv|add_uv]] '''(''' [[Vector2 GD|Vector2]] uv ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                            |-| void|| [[#add_uv2|add_uv2]] '''(''' [[Vector2 GD|Vector2]] uv2 ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                         |-| void|| [[#add_vertex|add_vertex]] '''(''' [[Vector3 GD|Vector3]] vertex ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                |-| void|| [[#add_weights|add_weights]] '''(''' [[PackedFloat32Array GD|PackedFloat32Array]] weights ''')'''                                                                                                                                                                                                                                                                                                                                                                                       |-| void|| [[#append_from|append_from]] '''(''' [[Mesh GD|Mesh]] existing, int surface, [[Transform GD|Transform]] transform ''')'''                                                                                                                                                                                                                                                                                                                                      |-| void|| [[#begin|begin]] '''(''' [[#PrimitiveType|PrimitiveType]] primitive ''')'''                                                                                                                                                                                                                                                                                                                                                                                                       |-| void|| [[#clear|clear]] '''(''' ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                                                               |-| [[ArrayMesh GD|ArrayMesh]]|| [[#commit|commit]] '''(''' [[ArrayMesh GD|ArrayMesh]] existing=null, int flags=31744 ''')'''                                                                                                                                                                                                                                                                                                                                                                          |-| [[Array GD|Array]]|| [[#commit_to_arrays|commit_to_arrays]] '''(''' ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                                         |-| void|| [[#create_from|create_from]] '''(''' [[Mesh GD|Mesh]] existing, int surface ''')'''                                                                                                                                                                                                                                                                                                                                                                                   |-| void|| [[#create_from_blend_shape|create_from_blend_shape]] '''(''' [[Mesh GD|Mesh]] existing, int surface, [[String GD|String]] blend_shape ''')'''                                                                                                                                                                                                                                                                                                                  |-| void|| [[#deindex|deindex]] '''(''' ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                                                           |-| void|| [[#generate_normals|generate_normals]] '''(''' bool flip=false ''')'''                                                                                                                                                                                                                                                                                                                                                                                                      |-| void|| [[#generate_tangents|generate_tangents]] '''(''' ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                                       |-| void|| [[#index|index]] '''(''' ''')'''                                                                                                                                                                                                                                                                                                                                                                                                                                                               |-| void|| [[#set_material|set_material]] '''(''' [[Material GD|Material]] material ''')'''                                                                                                                                                                                                                                                                                                                                                                                                        |}== Method Descriptions ===== add_bones ===*  void '''add_bones''' '''(''' [[PackedInt32Array GD|PackedInt32Array]] bones ''')'''Adds an array of bones for the next vertex to use. {{Span|bones}} must contain 4 integers.=== add_color ===*  void '''add_color''' '''(''' [[Color GD|Color]] color ''')'''Specifies a [[Color GD|Color]] for the next vertex to use.=== add_index ===*  void '''add_index''' '''(''' int index ''')'''Adds an index to index array if you are using indexed vertices. Does not need to be called before adding vertices.=== add_normal ===*  void '''add_normal''' '''(''' [[Vector3 GD|Vector3]] normal ''')'''Specifies a normal for the next vertex to use.=== add_smooth_group ===*  void '''add_smooth_group''' '''(''' bool smooth ''')'''Specifies whether the current vertex (if using only vertex arrays) or current index (if also using index arrays) should use smooth normals for normal calculation.=== add_tangent ===*  void '''add_tangent''' '''(''' [[Plane GD|Plane]] tangent ''')'''Specifies a tangent for the next vertex to use.=== add_triangle_fan ===*  void '''add_triangle_fan''' '''(''' [[PackedVector3Array GD|PackedVector3Array]] vertices, [[PackedVector2Array GD|PackedVector2Array]] uvs=PackedVector2Array(  ), [[PackedColorArray GD|PackedColorArray]] colors=PackedColorArray(  ), [[PackedVector2Array GD|PackedVector2Array]] uv2s=PackedVector2Array(  ), [[PackedVector3Array GD|PackedVector3Array]] normals=PackedVector3Array(  ), [[Array GD|Array]] tangents=[  ] ''')'''Inserts a triangle fan made of array data into [[Mesh GD|Mesh]] being constructed.Requires the primitive type be set to [[Mesh GD#PRIMITIVE_TRIANGLES|Mesh.PRIMITIVE_TRIANGLES()]].=== add_uv ===*  void '''add_uv''' '''(''' [[Vector2 GD|Vector2]] uv ''')'''Specifies a set of UV coordinates to use for the next vertex.=== add_uv2 ===*  void '''add_uv2''' '''(''' [[Vector2 GD|Vector2]] uv2 ''')'''Specifies an optional second set of UV coordinates to use for the next vertex.=== add_vertex ===*  void '''add_vertex''' '''(''' [[Vector3 GD|Vector3]] vertex ''')'''Specifies the position of current vertex. Should be called after specifying other vertex properties (e.g. Color, UV).=== add_weights ===*  void '''add_weights''' '''(''' [[PackedFloat32Array GD|PackedFloat32Array]] weights ''')'''Specifies weight values for next vertex to use. {{Span|weights}} must contain 4 values.=== append_from ===*  void '''append_from''' '''(''' [[Mesh GD|Mesh]] existing, int surface, [[Transform GD|Transform]] transform ''')'''Append vertices from a given [[Mesh GD|Mesh]] surface onto the current vertex array with specified [[Transform GD|Transform]].=== begin ===*  void '''begin''' '''(''' [[#PrimitiveType|PrimitiveType]] primitive ''')'''Called before adding any vertices. Takes the primitive type as an argument (e.g. [[Mesh GD#PRIMITIVE_TRIANGLES|Mesh.PRIMITIVE_TRIANGLES()]]).=== clear ===*  void '''clear ( )'''Clear all information passed into the surface tool so far.=== commit ===*  [[ArrayMesh GD|ArrayMesh]] '''commit''' '''(''' [[ArrayMesh GD|ArrayMesh]] existing=null, int flags=31744 ''')'''Returns a constructed [[ArrayMesh GD|ArrayMesh]] from current information passed in. If an existing [[ArrayMesh GD|ArrayMesh]] is passed in as an argument, will add an extra surface to the existing [[ArrayMesh GD|ArrayMesh]].Default flag is [[Mesh GD#ARRAY_COMPRESS_DEFAULT|Mesh.ARRAY_COMPRESS_DEFAULT()]]. See {{Span|ARRAY_COMPRESS_*}} constants in [[#ArrayFormat|ArrayFormat]] for other flags.=== commit_to_arrays ===*  [[Array GD|Array]] '''commit_to_arrays ( )'''Commits the data to the same format used by [[ArrayMesh GD#add_surface_from_arrays|ArrayMesh.add_surface_from_arrays()]]. This way you can further process the mesh data using the [[ArrayMesh GD|ArrayMesh]] API.=== create_from ===*  void '''create_from''' '''(''' [[Mesh GD|Mesh]] existing, int surface ''')'''Creates a vertex array from an existing [[Mesh GD|Mesh]].=== create_from_blend_shape ===*  void '''create_from_blend_shape''' '''(''' [[Mesh GD|Mesh]] existing, int surface, [[String GD|String]] blend_shape ''')'''Creates a vertex array from the specified blend shape of an existing [[Mesh GD|Mesh]]. This can be used to extract a specific pose from a blend shape.=== deindex ===*  void '''deindex ( )'''Removes the index array by expanding the vertex array.=== generate_normals ===*  void '''generate_normals''' '''(''' bool flip=false ''')'''Generates normals from vertices so you do not have to do it manually. If {{Span|flip}} is {{Span|true}}, the resulting normals will be inverted.Requires the primitive type to be set to [[Mesh GD#PRIMITIVE_TRIANGLES|Mesh.PRIMITIVE_TRIANGLES()]].=== generate_tangents ===*  void '''generate_tangents ( )'''Generates a tangent vector for each vertex. Requires that each vertex have UVs and normals set already.=== index ===*  void '''index ( )'''Shrinks the vertex array by creating an index array (avoids reusing vertices).=== set_material ===*  void '''set_material''' '''(''' [[Material GD|Material]] material ''')'''Sets [[Material GD|Material]] to be used by the [[Mesh GD|Mesh]] you are constructing.